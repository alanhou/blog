---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import BilingualContent from '../../components/BilingualContent.astro';
import Comments from '../../components/Comments.astro';
import SeriesNav from '../../components/SeriesNav.astro';

export async function getStaticPaths() {
const posts = await getCollection('blog');
return posts.map(post => ({
  params: { slug: post.slug },
  props: { post },
}));
}

const { post } = Astro.props;
const { Content } = await post.render();
const title = post.data.title.en || post.data.title.zh || 'Blog Post';
const hasSeries = post.data.series && post.data.seriesOrder;
---
<Layout title={title}>
<article>
  <h1>{post.data.title.en}</h1>
  <h2>{post.data.title.zh}</h2>
  <time>{post.data.date.toLocaleDateString()}</time>
  {hasSeries && (
    <SeriesNav
      currentSlug={post.slug}
      series={post.data.series}
      seriesOrder={post.data.seriesOrder}
    />
  )}
  <BilingualContent>
    <Content />
  </BilingualContent>
</article>
{hasSeries && (
  <SeriesNav
    currentSlug={post.slug}
    series={post.data.series}
    seriesOrder={post.data.seriesOrder}
  />
)}
<a href="/blog">‚Üê Back to Blog</a>
<Comments />
</Layout>

---
title:
  en: "TouchDesigner Tutorial: Basics of Instancing"
  zh: "TouchDesigner教程：实例化基础"
description:
  en: "Learn the fundamentals of GPU instancing for efficient rendering of multiple geometry copies in TouchDesigner"
  zh: "学习TouchDesigner中GPU实例化的基础知识，高效渲染多个几何体副本"
date: 2024-08-30
tags: ["touchdesigner", "tutorial", "instancing", "gpu", "creative-coding"]
series: "touchdesigner-tutorial"
image: "https://i.ytimg.com/vi/nRV2CtTC3to/hqdefault.jpg"
---

import YouTube from '../../components/YouTube.astro';

<YouTube id="nRV2CtTC3to" title="TouchDesigner Tutorial: Basics of Instancing" />

:::en
This tutorial covers the fundamental principles and concepts of instancing in TouchDesigner, demonstrating how to efficiently render multiple copies of geometry using GPU-based techniques.

## What is Instancing?

Instances are copies of geometry that are handled exclusively on the GPU. This makes instancing a far more efficient way to draw and manipulate many copies of a piece of geometry compared to traditional methods. Instead of creating separate geometry components for each copy, instancing allows you to define one piece of geometry and control multiple copies through channel data.

## Setting Up Basic Instancing

### Step 1: Create the Geometry

Start by adding a Box SOP to your network and connecting it to a Geometry component. This will be the base geometry that gets instanced.

### Step 2: Enable Instancing

Navigate to the Instance page of your Geometry component and turn on instancing. You'll need to specify an operator (OP) that serves as the source of data describing your instance positions.

### Step 3: Set Up the Instance Data Source

Create a Constant CHOP connected to a Null CHOP. Set this Null as your default instance OP. The Constant CHOP will hold the channel data that controls your instances.

## Controlling Instance Attributes

### Translation (Position)

Add three channels to your Constant CHOP:
- **TX** - X position
- **TY** - Y position
- **TZ** - Z position

On the Geometry component's Instance page, set the Translate X, Y, and Z parameters to pull from these respective channels. Each sample in your channels represents a different instance.

### Creating Multiple Instances

Use a Join CHOP to merge multiple Constant CHOPs together. The Join CHOP places samples in sequence, so each sample describes a separate instance. For example:
- First Constant: TX = -2 (instance on the left)
- Second Constant: TX = 2 (instance on the right)
- Third Constant: TX = 0 (instance in the center)

### Rotation

Add rotation channels to control instance orientation:
- **RX** - Rotation around X axis
- **RY** - Rotation around Y axis
- **RZ** - Rotation around Z axis

Update the Geometry component's Instance page to pull rotation data from these channels.

### Scale

Add scale channels for size control:
- **SX** - Scale in X dimension
- **SY** - Scale in Y dimension
- **SZ** - Scale in Z dimension

Set default values to 1 for uniform scaling, then adjust per instance as needed.

### Color

On the Instance 2 page of the Geometry component, you'll find color parameters. Add color channels:
- **R** - Red channel
- **G** - Green channel
- **B** - Blue channel

Map these to the corresponding color parameters to give each instance a unique color.

## Key Concepts

### Sample-Based Instance Control

Every sample inside your channels describes another instance. This is the fundamental concept that makes instancing powerful - you can control hundreds or thousands of instances simply by adding more samples to your channel data.

### GPU Efficiency

Because instances are handled entirely on the GPU, this approach is significantly more efficient than creating separate geometry components. This is crucial for real-time performance when working with large numbers of objects.

### Flexible Data Sources

While this tutorial uses a single default instance OP for all attributes, you can actually pull data from separate operators for different attributes:
- One OP for translation data
- Another OP for rotation data
- Another OP for scale data
- And so on for Instance 2 page attributes

## Practical Tips

1. **Use Null CHOPs** - Always connect your data through a Null CHOP before referencing it in the Geometry component. This provides a clean reference point.

2. **Snapshot Channels** - When adding new channels to existing Constant CHOPs, use the snapshot feature to capture all channels and update values efficiently.

3. **Match Channel Names** - Ensure your channel names (TX, TY, TZ, etc.) match what you reference in the Geometry component's Instance parameters.

4. **Start Simple** - Begin with position control, then add rotation, scale, and color as needed.

## Summary

Instancing in TouchDesigner provides a GPU-optimized way to render multiple copies of geometry with individual control over position, rotation, scale, and color. By using CHOP data to drive instance attributes, you can create complex animations and visualizations that would be impossible with traditional geometry duplication methods.

This tutorial covers the foundational concepts - there's much more you can do with instancing, including using different data sources for different attributes and creating procedural animations through CHOP networks.
:::

:::zh
本教程介绍TouchDesigner中实例化的基本原理和概念，演示如何使用基于GPU的技术高效渲染多个几何体副本。

## 什么是实例化？

实例是完全由GPU处理的几何体副本。与传统方法相比，这使得实例化成为绘制和操作大量几何体副本的更高效方式。实例化不需要为每个副本创建单独的几何体组件，而是允许你定义一个几何体，并通过通道数据控制多个副本。

## 设置基本实例化

### 步骤1：创建几何体

首先在网络中添加一个Box SOP，并将其连接到Geometry组件。这将是被实例化的基础几何体。

### 步骤2：启用实例化

导航到Geometry组件的Instance页面，打开实例化功能。你需要指定一个操作符（OP）作为描述实例位置的数据源。

### 步骤3：设置实例数据源

创建一个Constant CHOP并连接到Null CHOP。将这个Null设置为默认实例OP。Constant CHOP将保存控制实例的通道数据。

## 控制实例属性

### 平移（位置）

在Constant CHOP中添加三个通道：
- **TX** - X位置
- **TY** - Y位置
- **TZ** - Z位置

在Geometry组件的Instance页面上，设置Translate X、Y和Z参数从这些相应的通道获取数据。通道中的每个采样代表一个不同的实例。

### 创建多个实例

使用Join CHOP合并多个Constant CHOP。Join CHOP按顺序放置采样，因此每个采样描述一个单独的实例。例如：
- 第一个Constant：TX = -2（左侧的实例）
- 第二个Constant：TX = 2（右侧的实例）
- 第三个Constant：TX = 0（中心的实例）

### 旋转

添加旋转通道来控制实例方向：
- **RX** - 绕X轴旋转
- **RY** - 绕Y轴旋转
- **RZ** - 绕Z轴旋转

更新Geometry组件的Instance页面，从这些通道获取旋转数据。

### 缩放

添加缩放通道进行大小控制：
- **SX** - X维度缩放
- **SY** - Y维度缩放
- **SZ** - Z维度缩放

将默认值设置为1以实现均匀缩放，然后根据需要调整每个实例。

### 颜色

在Geometry组件的Instance 2页面上，你会找到颜色参数。添加颜色通道：
- **R** - 红色通道
- **G** - 绿色通道
- **B** - 蓝色通道

将这些映射到相应的颜色参数，为每个实例赋予独特的颜色。

## 核心概念

### 基于采样的实例控制

通道中的每个采样描述另一个实例。这是使实例化强大的基本概念——你可以通过简单地向通道数据添加更多采样来控制数百或数千个实例。

### GPU效率

由于实例完全由GPU处理，这种方法比创建单独的几何体组件效率高得多。这对于处理大量对象时的实时性能至关重要。

### 灵活的数据源

虽然本教程使用单个默认实例OP来处理所有属性，但你实际上可以从不同的操作符获取不同属性的数据：
- 一个OP用于平移数据
- 另一个OP用于旋转数据
- 另一个OP用于缩放数据
- Instance 2页面属性也是如此

## 实用技巧

1. **使用Null CHOP** - 在Geometry组件中引用数据之前，始终通过Null CHOP连接数据。这提供了一个干净的参考点。

2. **快照通道** - 向现有Constant CHOP添加新通道时，使用快照功能捕获所有通道并高效更新值。

3. **匹配通道名称** - 确保你的通道名称（TX、TY、TZ等）与Geometry组件Instance参数中引用的名称匹配。

4. **从简单开始** - 先从位置控制开始，然后根据需要添加旋转、缩放和颜色。

## 总结

TouchDesigner中的实例化提供了一种GPU优化的方式来渲染多个几何体副本，并对位置、旋转、缩放和颜色进行单独控制。通过使用CHOP数据驱动实例属性，你可以创建使用传统几何体复制方法无法实现的复杂动画和可视化效果。

本教程涵盖了基础概念——实例化还有更多功能，包括为不同属性使用不同的数据源，以及通过CHOP网络创建程序化动画。
:::

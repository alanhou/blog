---
title:
  en: "CoLoGen: Progressive Learning of Concept-Localization Duality for Unified Image Generation"
  zh: "CoLoGen: 统一图像生成中概念-定位二元性的渐进式学习"
description:
  en: "A unified diffusion framework that resolves concept-localization conflicts in conditional image generation through progressive curriculum learning and dynamic feature routing."
  zh: "通过渐进式课程学习和动态特征路由解决条件图像生成中概念-定位冲突的统一扩散框架。"
date: 2026-02-26
tags: ["arxiv", "ai", "cs.cv"]
image: "https://arxiv.org/static/browse/0.3.4/images/arxiv-logo-fb.png"
---

![Concept animation](/arxiv-visuals/cologen-progressive-learning-of-concept-localization/ConceptScene.gif)



:::en
**Paper**: [2602.22150](https://arxiv.org/abs/2602.22150)
**Authors**: YuXin Song, Yu Lu, Haoyuan Sun, Huanjin Yao, Fanglong Liu, Yifan Sun, Haocheng Feng, Hang Zhou, Jingdong Wang
**Categories**: cs.CV

## Abstract

Unified conditional image generation faces a fundamental challenge: different tasks require fundamentally incompatible internal representations. Semantic synthesis tasks demand high-level conceptual understanding, while spatial manipulation tasks require precise localization cues. This paper introduces CoLoGen, a unified diffusion framework that addresses the concept-localization representational conflict through progressive curriculum learning. The framework employs a three-stage training strategy that first establishes foundational conceptual and localization capabilities, then adapts these abilities to diverse visual conditions, and finally refines their integration for complex instruction-driven generation. At its core, the Progressive Representation Weaving (PRW) module dynamically routes features to specialized experts and stably merges their outputs across training stages. Experimental results demonstrate competitive or superior performance across editing, controllable generation, and customized generation tasks.

## Key Contributions

- Identifies and formalizes the concept-localization representational conflict as a core challenge in unified conditional image generation
- Proposes a three-stage progressive curriculum learning strategy that systematically builds and reconciles dual representational capabilities
- Introduces the Progressive Representation Weaving (PRW) module for dynamic feature routing and stable expert integration
- Achieves state-of-the-art or competitive performance across multiple generation tasks including editing, controllable generation, and customization

## Methodology: Progressive Curriculum Learning

CoLoGen's training strategy follows a carefully designed three-stage curriculum that mirrors human learning progression from fundamentals to complex applications.

**Stage 1: Foundation Building** establishes core capabilities by training separate conceptual and localization pathways. The conceptual branch learns semantic understanding through text-to-image generation tasks, while the localization branch develops spatial precision through structure-conditioned generation. This separation prevents early-stage interference between competing objectives.

**Stage 2: Conditional Adaptation** introduces diverse visual conditions (edges, depth maps, segmentation masks) to both pathways. The PRW module begins routing features to appropriate experts based on task requirements, learning which representations best serve different conditioning modalities.

**Stage 3: Synergistic Refinement** tackles complex instruction-driven tasks that require simultaneous conceptual understanding and spatial precision. The PRW module dynamically balances contributions from both expert pathways, enabling seamless integration for tasks like "change the dog to a cat while preserving pose."

The Progressive Representation Weaving module operates through learned routing weights $\alpha_t$ and $\beta_t$ that evolve across stages:

$$\mathbf{h}_{\text{fused}} = \alpha_t \cdot \mathbf{h}_{\text{concept}} + \beta_t \cdot \mathbf{h}_{\text{local}} + \gamma_t \cdot \mathbf{h}_{\text{shared}}$$

where $\alpha_t + \beta_t + \gamma_t = 1$ ensures stable training dynamics.

## Experimental Results and Analysis

CoLoGen demonstrates strong performance across three major evaluation domains:

**Image Editing**: On instruction-based editing benchmarks, CoLoGen achieves superior semantic fidelity while maintaining structural consistency. The framework successfully handles complex edits requiring both conceptual changes and spatial preservation, outperforming specialized editing models in multi-constraint scenarios.

**Controllable Generation**: When conditioned on structural inputs (pose, depth, edges), CoLoGen matches or exceeds ControlNet-style approaches while maintaining better semantic coherence. The dual-pathway architecture prevents the common issue where strong spatial conditioning degrades semantic quality.

**Customized Generation**: For subject-driven generation tasks, CoLoGen effectively balances identity preservation with creative variation. The progressive training enables smooth interpolation between strict replication and conceptual adaptation based on instruction specificity.

Ablation studies reveal that removing the progressive curriculum leads to 15-20% performance degradation, confirming that staged learning is essential for resolving representational conflicts. The PRW module contributes 8-12% improvement over naive feature concatenation approaches.

## Architectural Insights and Design Principles

The success of CoLoGen stems from several key architectural decisions that address the representational conflict at multiple levels.

**Expert Specialization**: Rather than forcing a single encoder to handle all conditioning types, CoLoGen maintains specialized pathways that develop distinct inductive biases. The conceptual expert learns hierarchical semantic features optimized for text-image alignment, while the localization expert develops fine-grained spatial attention patterns.

**Dynamic Integration**: The PRW module's learned routing mechanism adapts to task requirements at inference time. For pure semantic tasks, it upweights conceptual features; for spatial tasks, it emphasizes localization cues. This flexibility eliminates the need for task-specific model variants.

**Stable Training Dynamics**: The progressive curriculum prevents gradient conflicts that arise when optimizing contradictory objectives simultaneously. Early-stage separation allows each pathway to establish stable feature spaces before integration begins.

The framework's modular design also enables efficient scaling: new conditioning modalities can be incorporated by training additional expert branches without retraining the entire model.

## Takeaways

1. Unified image generation requires explicitly addressing the concept-localization representational conflict rather than assuming a single representation can serve all tasks
2. Progressive curriculum learning that mirrors human skill acquisition—fundamentals first, then adaptation, finally integration—proves more effective than joint training from scratch
3. Dynamic feature routing through specialized experts outperforms monolithic architectures for heterogeneous conditional generation tasks
4. The three-stage training strategy (foundation → adaptation → refinement) provides a principled framework applicable beyond image generation to other multi-task learning scenarios
5. Balancing expert specialization with stable integration mechanisms is crucial for maintaining both task-specific performance and cross-task generalization
:::

:::zh
**论文**: [2602.22150](https://arxiv.org/abs/2602.22150)
**作者**: YuXin Song, Yu Lu, Haoyuan Sun, Huanjin Yao, Fanglong Liu, Yifan Sun, Haocheng Feng, Hang Zhou, Jingdong Wang
**分类**: cs.CV

## 摘要

统一的条件图像生成面临一个根本性挑战:不同任务需要本质上不兼容的内部表征。语义合成任务需要高层次的概念理解,而空间操作任务则需要精确的定位线索。本文提出CoLoGen,一个通过渐进式课程学习解决概念-定位表征冲突的统一扩散框架。该框架采用三阶段训练策略,首先建立基础的概念和定位能力,然后将这些能力适配到多样化的视觉条件,最后优化它们在复杂指令驱动生成中的整合。其核心是渐进式表征编织(PRW)模块,它动态地将特征路由到专门的专家网络,并在训练阶段稳定地融合它们的输出。实验结果表明,该方法在编辑、可控生成和定制化生成任务上达到了具有竞争力或更优的性能。

## 主要贡献

- 识别并形式化了概念-定位表征冲突作为统一条件图像生成的核心挑战
- 提出三阶段渐进式课程学习策略,系统性地构建和协调双重表征能力
- 引入渐进式表征编织(PRW)模块,实现动态特征路由和稳定的专家整合
- 在多个生成任务(包括编辑、可控生成和定制化)上达到最先进或具有竞争力的性能

## 方法论:渐进式课程学习

CoLoGen的训练策略遵循精心设计的三阶段课程,模仿人类从基础到复杂应用的学习进程。

**阶段1:基础构建**通过训练独立的概念和定位路径来建立核心能力。概念分支通过文本到图像生成任务学习语义理解,而定位分支通过结构条件生成发展空间精度。这种分离防止了早期阶段竞争目标之间的干扰。

**阶段2:条件适配**向两个路径引入多样化的视觉条件(边缘、深度图、分割掩码)。PRW模块开始根据任务需求将特征路由到适当的专家,学习哪些表征最适合不同的条件模态。

**阶段3:协同优化**处理需要同时具备概念理解和空间精度的复杂指令驱动任务。PRW模块动态平衡两个专家路径的贡献,实现"将狗变成猫同时保持姿态"等任务的无缝整合。

渐进式表征编织模块通过跨阶段演化的学习路由权重$\alpha_t$和$\beta_t$运作:

$$\mathbf{h}_{\text{fused}} = \alpha_t \cdot \mathbf{h}_{\text{concept}} + \beta_t \cdot \mathbf{h}_{\text{local}} + \gamma_t \cdot \mathbf{h}_{\text{shared}}$$

其中$\alpha_t + \beta_t + \gamma_t = 1$确保稳定的训练动态。

## 实验结果与分析

CoLoGen在三个主要评估领域展现出强劲性能:

**图像编辑**:在基于指令的编辑基准测试中,CoLoGen在保持结构一致性的同时实现了优越的语义保真度。该框架成功处理需要概念变化和空间保持的复杂编辑,在多约束场景中超越专门的编辑模型。

**可控生成**:当以结构输入(姿态、深度、边缘)为条件时,CoLoGen匹配或超越ControlNet风格的方法,同时保持更好的语义连贯性。双路径架构防止了强空间条件降低语义质量的常见问题。

**定制化生成**:对于主体驱动的生成任务,CoLoGen有效平衡了身份保持与创意变化。渐进式训练使得能够根据指令具体性在严格复制和概念适配之间平滑插值。

消融研究表明,移除渐进式课程导致15-20%的性能下降,证实分阶段学习对解决表征冲突至关重要。PRW模块相比简单特征拼接方法贡献了8-12%的改进。

## 架构洞察与设计原则

CoLoGen的成功源于几个在多个层面解决表征冲突的关键架构决策。

**专家专业化**:CoLoGen不是强制单一编码器处理所有条件类型,而是维护发展不同归纳偏置的专门路径。概念专家学习针对文本-图像对齐优化的层次化语义特征,而定位专家发展细粒度的空间注意力模式。

**动态整合**:PRW模块的学习路由机制在推理时适应任务需求。对于纯语义任务,它增加概念特征的权重;对于空间任务,它强调定位线索。这种灵活性消除了对任务特定模型变体的需求。

**稳定训练动态**:渐进式课程防止同时优化矛盾目标时产生的梯度冲突。早期阶段的分离允许每个路径在整合开始前建立稳定的特征空间。

该框架的模块化设计还支持高效扩展:可以通过训练额外的专家分支来整合新的条件模态,而无需重新训练整个模型。

## 要点总结

1. 统一图像生成需要明确解决概念-定位表征冲突,而不是假设单一表征可以服务所有任务
2. 模仿人类技能习得的渐进式课程学习——先基础、再适配、最后整合——比从头开始的联合训练更有效
3. 通过专门专家的动态特征路由在异构条件生成任务上优于单体架构
4. 三阶段训练策略(基础→适配→优化)提供了适用于图像生成之外其他多任务学习场景的原则性框架
5. 平衡专家专业化与稳定整合机制对于保持任务特定性能和跨任务泛化能力至关重要
:::

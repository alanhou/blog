---
// Giscus comments component
---
<div class="comments-section">
  <script 
    src="https://giscus.app/client.js"
    data-repo="alanhou/blog"
    data-repo-id="R_kgDORIlbHg"
    data-category="Announcements"
    data-category-id="DIC_kwDORIlbHs4C15jD"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="preferred_color_scheme"
    data-lang="en"
    crossorigin="anonymous"
    async>
  </script>
</div>

<style>
.comments-section {
  margin-top: 4rem;
  padding-top: 2rem;
  border-top: 1px solid var(--border);
}
</style>

<script>
// Update Giscus theme when user toggles dark mode
const observer = new MutationObserver(() => {
  const iframe = document.querySelector('iframe.giscus-frame');
  if (iframe) {
    const theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
    iframe.contentWindow?.postMessage(
      { giscus: { setConfig: { theme } } },
      'https://giscus.app'
    );
  }
});

observer.observe(document.documentElement, {
  attributes: true,
  attributeFilter: ['class']
});
</script>
